(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{"4Cxu":function(e,t,r){"use strict";r.r(t);r("2qtc");var n=r("kLXV"),a=(r("DYRE"),r("zeV3")),o=(r("5NDa"),r("5rEg")),c=(r("sRBo"),r("kaz8")),l=(r("Mwp2"),r("VXEj")),i=(r("/zsF"),r("PArb")),f=(r("P2fV"),r("NJEC")),u=(r("+BJd"),r("mr32")),s=(r("+L6B"),r("2/Rp")),d=r("VTBJ"),m=(r("miYZ"),r("tsqr")),b=r("ODXe"),p=(r("OaEy"),r("2fM7")),E=r("q1tI"),O=r.n(E),_=r("xvlK"),j=r("TW7M"),h=r("9kvl"),v=(r("ec0t"),p["a"].Option),I=function(e){var t=e.dispatch,r=e.roleInfo,p=r.perInfo,h=void 0===p?[]:p,I=r.roles,y=void 0===I?[]:I,k=r.rolePer,g=void 0===k?[]:k,S=Object(E["useState"])(1),C=Object(b["a"])(S,2),w=C[0],R=C[1],x=Object(E["useState"])([]),N=Object(b["a"])(x,2),P=N[0],V=N[1],J=Object(E["useState"])(g),B=Object(b["a"])(J,2),q=B[0],z=B[1],D=Object(E["useState"])([]),L=Object(b["a"])(D,2),M=L[0],X=L[1],A=Object(E["useState"])(!1),T=Object(b["a"])(A,2),Y=T[0],F=T[1],G=Object(E["useState"])(!1),K=Object(b["a"])(G,2),W=K[0],Z=K[1],H=Object(E["useState"])(),Q=Object(b["a"])(H,2),U=Q[0],$=Q[1],ee=Object(E["useState"])(),te=Object(b["a"])(ee,2),re=te[0],ne=te[1],ae=Object(E["useState"])(),oe=Object(b["a"])(ae,2),ce=oe[0],le=oe[1],ie=Object(E["useState"])(),fe=Object(b["a"])(ie,2),ue=fe[0],se=fe[1],de=Object(E["useState"])(),me=Object(b["a"])(de,2),be=me[0],pe=me[1],Ee=Object(E["useState"])(),Oe=Object(b["a"])(Ee,2),_e=Oe[0],je=Oe[1];Object(E["useEffect"])((function(){t({type:"roleInfo/fetchPerInfo"}),t({type:"roleInfo/fetchRoleInfo"})}),[]);var he=function(){F(!0)},ve=function(){Z(!0),Object(j["a"])({role_name:U,role_desc:re,role_id:ue}).then((function(e){0===e.errno?(m["default"].success("\b\u89d2\u8272\u6dfb\u52a0\u6210\u529f"),t({type:"roleInfo/fetchRoleInfo"}),F(!1)):m["default"].error(e.errno+": "+e.error),Z(!1)}))},Ie=function(){Z(!0),Object(j["c"])({role_name:U,role_desc:re,role_id:ue}).then((function(e){0===e.errno?(m["default"].success("\b\u89d2\u8272\u4fee\u6539\u6210\u529f"),t({type:"roleInfo/fetchRoleInfo"}),F(!1),se("")):m["default"].error(e.errno+": "+e.error),Z(!1)}))},ye=function(){Z(!0),Object(j["b"])({role_id:be,permission_ids:ce}).then((function(e){0===e.errno?(m["default"].success("\b\u89d2\u8272\u6743\u9650\u7ed1\u5b9a\u6210\u529f"),pe("")):m["default"].error(e.errno+": "+e.error),Z(!1)}))},ke=function(e){Object(j["d"])(Object(d["a"])({},e)).then((function(e){0===e.errno?(m["default"].success("\b\u89d2\u8272\u5220\u9664\u6210\u529f"),t({type:"roleInfo/fetchRoleInfo"})):m["default"].error(e.errno+": "+e.error)}))},ge=function(){F(!1)},Se=[];function Ce(e){le("".concat(e))}return h&&h.forEach((function(e){Se.push(O.a.createElement(v,{key:e.permission_id},e.permission_id+": "+e.per_name+"-"+e.per_desc))})),Object(E["useEffect"])((function(){var e=[];h&&(X(Array.from(new Set(h.map((function(e){return e.group}))))),h.forEach((function(t){e[t.group]?e[t.group].push(t):e[t.group]=[Object(d["a"])({},t)]})),V(e))}),[h]),Object(E["useEffect"])((function(){R(w+1)}),[q]),O.a.createElement("div",{key:w,className:"role_main",style:{backgroundColor:"#fff"}},O.a.createElement(c["a"].Group,{defaultValue:q,style:{width:"100%"},onChange:Ce},O.a.createElement(l["b"],{header:O.a.createElement("div",{className:"role_flex_row"},O.a.createElement("span",{onClick:function(){pe(""),je("")}},"\u89d2\u8272\u6743\u9650\u5206\u914d",_e?"/ "+_e:""),O.a.createElement(s["a"],{type:"primary",onClick:function(){he(),se("")},icon:O.a.createElement(_["a"],null)},"\u6dfb\u52a0\u89d2\u8272")),footer:O.a.createElement("div",{className:"role_flex_row"},O.a.createElement("span",null),be&&ce&&O.a.createElement(s["a"],{onClick:ye,type:"primary"},"\u786e\u8ba4\u7ed1\u5b9a")),bordered:!0,split:!0,dataSource:be?M:y,renderItem:function(e){return be?O.a.createElement(l["b"].Item,{key:e.role_id},O.a.createElement("div",null,O.a.createElement(u["a"],{color:"#108ee9"},e),O.a.createElement("div",{className:"check_group_item"},P[e].map((function(e){return O.a.createElement(c["a"],{value:e.permission_id},e.per_desc&&"\u65e0"!==e.per_desc?e.per_desc:e.per_name)}))))):O.a.createElement(l["b"].Item,{key:e.role_id},O.a.createElement("div",null,e.role_name),O.a.createElement("div",null,O.a.createElement(f["a"],{title:"\u662f\u5426\u8981\u4fee\u6539\u8be5\u89d2\u8272\uff1f",onConfirm:function(){he(),se(e.role_id)}},O.a.createElement(u["a"],{color:"#108ee9"},"\u4fee\u6539")),O.a.createElement(i["a"],{type:"vertical"}),O.a.createElement(u["a"],{color:"#87d068",onClick:function(){pe(e.role_id),je(e.role_name),t({type:"roleInfo/fetchRolePer",role_id:e.role_id,callback:z})}},"\u7ed1\u5b9a\u6743\u9650"),O.a.createElement(i["a"],{type:"vertical"}),O.a.createElement(f["a"],{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u89d2\u8272\uff1f",onConfirm:function(){return ke({role_id:e.role_id,role_name:e.role_name})}},O.a.createElement(u["a"],{color:"#cd201f"},"\u5220\u9664"))))}}),O.a.createElement(n["a"],{title:"\u6dfb\u52a0\u89d2\u8272",visible:Y,onOk:ue?Ie:ve,confirmLoading:W,onCancel:ge},O.a.createElement(a["b"],{direction:"vertical"},O.a.createElement(o["a"],{value:U,type:"text",onChange:function(e){$(e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}),O.a.createElement(o["a"],{value:re,type:"text",onChange:function(e){ne(e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u63cf\u8ff0"})))))};t["default"]=Object(h["a"])((function(e){var t=e.roleInfo,r=e.loading;return{roleInfo:t,loading:r.effects["roleInfo/fetchPerInfo"]||r.effects["roleInfo/fetchRoleInfo"]}}))(I)},ec0t:function(e,t,r){}}]);